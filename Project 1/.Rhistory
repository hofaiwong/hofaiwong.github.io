x='Score',
y='Restaurant density') +
scale_y_continuous(breaks=seq(0,0.14,0.02),
labels = scales::percent) +
scale_colour_brewer(name="Borough", palette='Set1') +
theme_bw() +
theme(legend.key=element_blank()) +
geom_vline(xintercept = c(14,28)) +
annotate("text", x = c(5,20,35), y = 0.11, label = c('A','B','C'))
ggplot(data=latest, aes (x=score)) +
geom_density(aes(color=boro)) +
coord_cartesian(xlim=c(0,40)) +
labs(title='Density of restaurants by latest score and borough',
x='Score',
y='Restaurant density') +
scale_y_continuous(breaks=seq(0,0.14,0.02),
labels = scales::percent) +
scale_colour_brewer(name="Borough", palette='Set1') +
theme_bw() +
theme(legend.key=element_blank()) +
geom_vline(xintercept = c(14,28)) +
annotate("text", x = c(5,20,35), y = 0.11, label = c('A','B','C')) +
annotate("rect", xmin = 0, xmax = 14, ymin = 0, ymax = 0.13, alpha = .2)
ggplot(data=latest, aes (x=score)) +
geom_density(aes(color=boro)) +
coord_cartesian(xlim=c(0,40)) +
labs(title='Density of restaurants by latest score and borough',
x='Score',
y='Restaurant density') +
scale_y_continuous(breaks=seq(0,0.14,0.02),
labels = scales::percent) +
scale_colour_brewer(name="Borough", palette='Set1') +
theme_bw() +
theme(legend.key=element_blank()) +
geom_vline(xintercept = c(14,28)) +
annotate("text", x = c(7,20,35), y = 0.11, label = c('A','B','C')) +
annotate("rect", xmin = 0, xmax = 14, ymin = 0, ymax = 0.13, alpha = .2)
ggplot(data=latest, aes (x=score)) +
geom_density(aes(color=boro)) +
coord_cartesian(xlim=c(0,40)) +
labs(title='Density of restaurants by latest score and borough',
x='Score',
y='Restaurant density') +
scale_y_continuous(breaks=seq(0,0.14,0.02),
labels = scales::percent) +
scale_colour_brewer(name="Borough", palette='Set1') +
theme_bw() +
theme(legend.key=element_blank()) +
geom_vline(xintercept = c(14,28)) +
annotate("text", x = c(6,20,35), y = 0.11, label = c('A','B','C')) +
annotate("rect", xmin = 0, xmax = 14, ymin = 0, ymax = 0.14, alpha = .2)
ggplot(data=latest, aes (x=score)) +
geom_density(aes(color=boro)) +
coord_cartesian(xlim=c(0,40)) +
labs(title='Density of restaurants by latest score and borough',
x='Score',
y='Restaurant density') +
scale_y_continuous(breaks=seq(0,0.14,0.02),
labels = scales::percent) +
scale_colour_brewer(name="Borough", palette='Set1') +
theme_bw() +
theme(legend.key=element_blank()) +
geom_vline(xintercept = c(14,28)) +
annotate("text", x = c(6,20,35), y = 0.11, label = c('A','B','C')) +
annotate("rect", xmin = 0, xmax = 14, ymin = 0, ymax = 0.14, alpha = .2, colour='red')
ggplot(data=latest, aes (x=score)) +
geom_density(aes(color=boro)) +
coord_cartesian(xlim=c(0,40)) +
labs(title='Density of restaurants by latest score and borough',
x='Score',
y='Restaurant density') +
scale_y_continuous(breaks=seq(0,0.14,0.02),
labels = scales::percent) +
scale_colour_brewer(name="Borough", palette='Set1') +
theme_bw() +
theme(legend.key=element_blank()) +
geom_vline(xintercept = c(14,28)) +
annotate("text", x = c(6,20,35), y = 0.11, label = c('A','B','C')) +
annotate("rect", xmin = 0, xmax = 14, ymin = 0, ymax = 0.14, alpha = .2, fill='red')
ggplot(data=latest, aes (x=score)) +
geom_density(aes(color=boro)) +
coord_cartesian(xlim=c(0,40)) +
labs(title='Density of restaurants by latest score and borough',
x='Score',
y='Restaurant density') +
scale_y_continuous(breaks=seq(0,0.14,0.02),
labels = scales::percent) +
scale_colour_brewer(name="Borough", palette='Set1') +
theme_bw() +
theme(legend.key=element_blank()) +
geom_vline(xintercept = c(14,28)) +
annotate("text", x = c(6,20,35), y = 0.11, label = c('A','B','C')) +
annotate("rect", xmin = 0, xmax = 14, ymin = 0, ymax = 0.14, alpha = .2, fill='darkred')
ggplot(data=latest, aes (x=score)) +
geom_density(aes(color=boro)) +
coord_cartesian(xlim=c(0,40)) +
labs(title='Density of restaurants by latest score and borough',
x='Score',
y='Restaurant density') +
scale_y_continuous(breaks=seq(0,0.14,0.02),
labels = scales::percent) +
scale_colour_brewer(name="Borough", palette='Set1') +
theme_bw() +
theme(legend.key=element_blank()) +
geom_vline(xintercept = c(14,28)) +
annotate("text", x = c(6,20,35), y = 0.11, label = c('A','B','C')) +
annotate("rect", xmin = 0, xmax = 14, ymin = 0, ymax = 0.14, alpha = .2, fill='darkred') +
annotate("rect", xmin = 14, xmax = 28, ymin = 0, ymax = 0.14, alpha = .2, fill='darkblue') +
annotate("rect", xmin = 28, xmax = 60, ymin = 0, ymax = 0.14, alpha = .2, fill='darkgreen')
ggplot(data=latest, aes (x=score)) +
geom_density(aes(color=boro)) +
coord_cartesian(xlim=c(0,40)) +
labs(title='Density of restaurants by latest score and borough',
x='Score',
y='Restaurant density') +
scale_y_continuous(breaks=seq(0,0.14,0.02),
labels = scales::percent) +
scale_colour_brewer(name="Borough", palette='Set1') +
theme_bw() +
theme(legend.key=element_blank()) +
geom_vline(xintercept = c(14,28), colour='grey') +
annotate("text", x = c(6,20,35), y = 0.11, label = c('A','B','C')) +
annotate("rect", xmin = 0, xmax = 14, ymin = 0, ymax = 0.14, alpha = .2, fill='darkred') +
annotate("rect", xmin = 14, xmax = 28, ymin = 0, ymax = 0.14, alpha = .2, fill='darkblue') +
annotate("rect", xmin = 28, xmax = 60, ymin = 0, ymax = 0.14, alpha = .2, fill='darkgreen')
ggplot(data=latest, aes (x=score)) +
geom_density(aes(color=boro)) +
coord_cartesian(xlim=c(0,40)) +
labs(title='Density of restaurants by latest score and borough',
x='Score',
y='Restaurant density') +
scale_y_continuous(breaks=seq(0,0.14,0.02),
labels = scales::percent) +
scale_colour_brewer(name="Borough", palette='Set1') +
theme_bw() +
theme(legend.key=element_blank()) +
geom_vline(xintercept = c(14,28), colour='grey', size=14) +
annotate("text", x = c(6,20,35), y = 0.11, label = c('A','B','C')) +
annotate("rect", xmin = 0, xmax = 14, ymin = 0, ymax = 0.14, alpha = .2, fill='darkred') +
annotate("rect", xmin = 14, xmax = 28, ymin = 0, ymax = 0.14, alpha = .2, fill='darkblue') +
annotate("rect", xmin = 28, xmax = 60, ymin = 0, ymax = 0.14, alpha = .2, fill='darkgreen')
ggplot(data=latest, aes (x=score)) +
geom_density(aes(color=boro)) +
coord_cartesian(xlim=c(0,40)) +
labs(title='Density of restaurants by latest score and borough',
x='Score',
y='Restaurant density') +
scale_y_continuous(breaks=seq(0,0.14,0.02),
labels = scales::percent) +
scale_colour_brewer(name="Borough", palette='Set1') +
theme_bw() +
theme(legend.key=element_blank()) +
geom_vline(xintercept = c(14,28), colour='grey') +
annotate("text", x = c(6,20,35), y = 0.11, label = c('A','B','C'), size=14) +
annotate("rect", xmin = 0, xmax = 14, ymin = 0, ymax = 0.14, alpha = .2, fill='darkred') +
annotate("rect", xmin = 14, xmax = 28, ymin = 0, ymax = 0.14, alpha = .2, fill='darkblue') +
annotate("rect", xmin = 28, xmax = 60, ymin = 0, ymax = 0.14, alpha = .2, fill='darkgreen')
ggplot(data=latest, aes (x=score)) +
geom_density(aes(color=boro)) +
coord_cartesian(xlim=c(0,40)) +
labs(title='Density of restaurants by latest score and borough',
x='Score',
y='Restaurant density') +
scale_y_continuous(breaks=seq(0,0.14,0.02),
labels = scales::percent) +
scale_colour_brewer(name="Borough", palette='Set1') +
theme_bw() +
theme(legend.key=element_blank()) +
geom_vline(xintercept = c(14,28), colour='grey') +
annotate("text", x = c(6,20,35), y = 0.11, label = c('A','B','C'), size=10) +
annotate("rect", xmin = 0, xmax = 14, ymin = 0, ymax = 0.14, alpha = .2, fill='darkred') +
annotate("rect", xmin = 14, xmax = 28, ymin = 0, ymax = 0.14, alpha = .2, fill='darkblue') +
annotate("rect", xmin = 28, xmax = 60, ymin = 0, ymax = 0.14, alpha = .2, fill='darkgreen')
ggplot(data=latest, aes (x=score)) +
geom_density(aes(color=boro)) +
coord_cartesian(xlim=c(0,40)) +
labs(title='Density of restaurants by latest score and borough',
x='Score',
y='Restaurant density') +
scale_y_continuous(breaks=seq(0,0.14,0.02),
labels = scales::percent) +
scale_colour_brewer(name="Borough", palette='Set1') +
theme_bw() +
theme(legend.key=element_blank()) +
geom_vline(xintercept = c(14,28), colour='grey') +
annotate("text", x = c(6,20,35), y = 0.11, label = c('A','B','C'), size=8) +
annotate("rect", xmin = 0, xmax = 14, ymin = 0, ymax = 0.14, alpha = .2, fill='darkred') +
annotate("rect", xmin = 14, xmax = 28, ymin = 0, ymax = 0.14, alpha = .2, fill='darkblue') +
annotate("rect", xmin = 28, xmax = 60, ymin = 0, ymax = 0.14, alpha = .2, fill='darkgreen')
ggplot(data=latest, aes (x=score)) +
geom_density(aes(color=boro)) +
coord_cartesian(xlim=c(0,40)) +
labs(title='Density of restaurants by latest score and borough',
x='Score',
y='Restaurant density') +
scale_y_continuous(breaks=seq(0,0.14,0.02),
labels = scales::percent) +
scale_colour_brewer(name="Borough", palette='Set1') +
theme_bw() +
theme(legend.key=element_blank()) +
geom_vline(xintercept = c(14,28), colour='grey') +
annotate("text", x = c(6,20,35), y = 0.11, label = c('A','B','C'), size=6) +
annotate("rect", xmin = 0, xmax = 14, ymin = 0, ymax = 0.14, alpha = .2, fill='darkred') +
annotate("rect", xmin = 14, xmax = 28, ymin = 0, ymax = 0.14, alpha = .2, fill='darkblue') +
annotate("rect", xmin = 28, xmax = 60, ymin = 0, ymax = 0.14, alpha = .2, fill='darkgreen')
ggplot(data=latest, aes (x=score)) +
geom_density(aes(color=boro)) +
coord_cartesian(xlim=c(0,40)) +
labs(title='Density of restaurants by latest score and borough',
x='Score',
y='Restaurant density') +
scale_y_continuous(breaks=seq(0,0.14,0.02),
labels = scales::percent) +
scale_colour_brewer(name="Borough", palette='Set1') +
theme_bw() +
theme(legend.key=element_blank()) +
geom_vline(xintercept = c(14,28), colour='grey') +
annotate("text", x = c(6,20,35), y = 0.11, label = c('A','B','C'), size=6) +
annotate("rect", xmin = 0, xmax = 14, ymin = 0, ymax = 0.13, alpha = .2, fill='darkred') +
annotate("rect", xmin = 14, xmax = 28, ymin = 0, ymax = 0.13, alpha = .2, fill='darkblue') +
annotate("rect", xmin = 28, xmax = 60, ymin = 0, ymax = 0.13, alpha = .2, fill='darkgreen')
ggplot(data=latest, aes (x=score)) +
stat_density(aes(color=boro)) +
coord_cartesian(xlim=c(0,40)) +
labs(title='Density of restaurants by latest score and borough',
x='Score',
y='Restaurant density') +
scale_y_continuous(breaks=seq(0,0.14,0.02),
labels = scales::percent) +
scale_colour_brewer(name="Borough", palette='Set1') +
theme_bw() +
theme(legend.key=element_blank()) +
geom_vline(xintercept = c(14,28), colour='grey') +
annotate("text", x = c(6,20,35), y = 0.11, label = c('A','B','C'), size=6) +
annotate("rect", xmin = 0, xmax = 14, ymin = 0, ymax = 0.13, alpha = .2, fill='darkred') +
annotate("rect", xmin = 14, xmax = 28, ymin = 0, ymax = 0.13, alpha = .2, fill='darkblue') +
annotate("rect", xmin = 28, xmax = 60, ymin = 0, ymax = 0.13, alpha = .2, fill='darkgreen')
ggplot(data=latest, aes (x=score)) +
stat_density(aes(color=boro), geom="line",position="identity") +
coord_cartesian(xlim=c(0,40)) +
labs(title='Density of restaurants by latest score and borough',
x='Score',
y='Restaurant density') +
scale_y_continuous(breaks=seq(0,0.14,0.02),
labels = scales::percent) +
scale_colour_brewer(name="Borough", palette='Set1') +
theme_bw() +
theme(legend.key=element_blank()) +
geom_vline(xintercept = c(14,28), colour='grey') +
annotate("text", x = c(6,20,35), y = 0.11, label = c('A','B','C'), size=6) +
annotate("rect", xmin = 0, xmax = 14, ymin = 0, ymax = 0.13, alpha = .2, fill='darkred') +
annotate("rect", xmin = 14, xmax = 28, ymin = 0, ymax = 0.13, alpha = .2, fill='darkblue') +
annotate("rect", xmin = 28, xmax = 60, ymin = 0, ymax = 0.13, alpha = .2, fill='darkgreen')
ggplot(data=latest, aes (x=score)) +
geom_density(aes(color=boro)) +
coord_cartesian(xlim=c(0,40)) +
labs(title='Density of restaurants by latest score and borough',
x='Score',
y='Restaurant density') +
scale_y_continuous(breaks=seq(0,0.14,0.02),
labels = scales::percent) +
scale_colour_brewer(name="Borough", palette='Set1') +
theme_bw() +
theme(legend.key=element_blank()) +
geom_vline(xintercept = c(14,28), colour='grey') +
annotate("text", x = c(6,20,35), y = 0.11, label = c('A','B','C'), size=6) +
annotate("rect", xmin = 0, xmax = 14, ymin = 0, ymax = 0.13, alpha = .2, fill='darkred') +
annotate("rect", xmin = 14, xmax = 28, ymin = 0, ymax = 0.13, alpha = .2, fill='darkblue') +
annotate("rect", xmin = 28, xmax = 60, ymin = 0, ymax = 0.13, alpha = .2, fill='darkgreen')
ggplot(data=latest, aes (x=score)) +
stat_density(aes(color=boro), geom="line",position="identity") +
coord_cartesian(xlim=c(0,40)) +
labs(title='Density of restaurants by latest score and borough',
x='Score',
y='Restaurant density') +
scale_y_continuous(breaks=seq(0,0.14,0.02),
labels = scales::percent) +
scale_colour_brewer(name="Borough", palette='Set1') +
theme_bw() +
theme(legend.key=element_blank()) +
geom_vline(xintercept = c(14,28), colour='grey') +
annotate("text", x = c(6,20,35), y = 0.11, label = c('A','B','C'), size=6) +
annotate("rect", xmin = 0, xmax = 14, ymin = 0, ymax = 0.13, alpha = .2, fill='darkred') +
annotate("rect", xmin = 14, xmax = 28, ymin = 0, ymax = 0.13, alpha = .2, fill='darkblue') +
annotate("rect", xmin = 28, xmax = 60, ymin = 0, ymax = 0.13, alpha = .2, fill='darkgreen')
ggplot(data=inspClosByCuisineBoro, aes(x=cuisine, y=ratio)) +
geom_bar(stat='identity', aes(fill=boro)) +
facet_grid(. ~ boro) +
labs(title='Inspection closure ratio by top 20 cuisine and borough', x='Cuisine (top 20)', y='Inspection closure ratio') +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = 'Set1', name = 'Borough') +
theme_bw() +
theme(legend.key=element_blank(), legend.position="bottom") +
coord_flip()
inspClosByCuisineBoro$cuisine = factor(inspClosByCuisineBoro$cuisine)
newFactor = levels(inspClosByCuisineBoro$cuisine)[order(-rank(inspClosByCuisine$ratio))]
inspClosByCuisineBoro$cuisine = factor(inspClosByCuisineBoro$cuisine, levels=rev(newFactor))
#Faceted bar plot: Inspection closure ratio by top 20 cuisine and borough
ggplot(data=inspClosByCuisineBoro, aes(x=cuisine, y=ratio)) +
geom_bar(stat='identity', aes(fill=boro)) +
facet_grid(. ~ boro) +
labs(title='Inspection closure ratio by top 20 cuisine and borough', x='Cuisine (top 20)', y='Inspection closure ratio') +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = 'Set1', name = 'Borough') +
theme_bw() +
theme(legend.key=element_blank(), legend.position="bottom") +
coord_flip()
inspClosByCuisineBoro = inspectionsFiltered %>%
group_by(., cuisine, boro) %>%
summarise(.,
closures = sum(action == 'closed' | action == 'reclosed'),
reclosures = sum(action == 'reclosed'),
inspections = n(),
ratio = closures / inspections
)
#Refactor cuisines to keep same order as in previous plot
inspClosByCuisineBoro$cuisine = factor(inspClosByCuisineBoro$cuisine)
newFactor = levels(inspClosByCuisineBoro$cuisine)[order(-rank(inspClosByCuisine$ratio))]
inspClosByCuisineBoro$cuisine = factor(inspClosByCuisineBoro$cuisine, levels=rev(newFactor))
#Faceted bar plot: Inspection closure ratio by top 20 cuisine and borough
ggplot(data=inspClosByCuisineBoro, aes(x=cuisine, y=ratio)) +
geom_bar(stat='identity', aes(fill=boro)) +
facet_grid(. ~ boro) +
labs(title='Inspection closure ratio by top 20 cuisine and borough', x='Cuisine (top 20)', y='Inspection closure ratio') +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = 'Set1', name = 'Borough') +
theme_bw() +
theme(legend.key=element_blank(), legend.position="bottom") +
coord_flip()
reclosedByCuisine = unique(
inspectionsFiltered %>%
filter(., action == 'closed') %>%
select(., camis, cuisine, inspection.date)) %>%
group_by(., camis, cuisine) %>%
summarise(., closures = n()) %>%
group_by(., cuisine) %>%
summarise(., closed_once = sum(closures==1),
closed_more_than_once = sum(closures>1),
total_closed = n(),
ratio = closed_more_than_once / total_closed)
#Bar plot: Ratio of restaurants by top 20 cuisine that were closed more than once, out of restaurants that were closed at least once
ggplot(data = reclosedByCuisine, aes (x = reorder(cuisine, ratio), y = ratio)) +
geom_bar(stat='identity') +
labs(title='Ratio of repeat closures by top 20 cuisine',
x='Cuisine (top 20)',
y='Repeat closure ratio') +
scale_y_continuous(limits=c(0,0.2),
breaks=seq(0,0.2,0.05),
labels=scales::percent) +
theme_bw() +
coord_flip()
#Down-select top 20 cuisine types for further analysis (out of 84)
restByCuisineFiltered = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n()) %>%
arrange(., desc(count)) %>%
top_n(., 20, count)
restaurantsFiltered = tbl_df(semi_join(restaurants, restByCuisineFiltered, by = 'cuisine')) #Will keep top 20 covering ~81%
inspectionsFiltered = tbl_df(semi_join(inspections, restByCuisineFiltered, by = 'cuisine'))
#Ratio of inspection closures by cuisine
inspClosByCuisine = inspectionsFiltered %>%
group_by(., cuisine) %>%
summarise(.,
closures = sum(action == 'closed' | action == 'reclosed'),
reclosures = sum(action == 'reclosed'),
inspections = n(),
ratio = closures / inspections
)
#Bar plot: Inspection closure ratio by top 20 cuisine
ggplot(data=inspClosByCuisine, aes(x=reorder(cuisine, ratio), y=ratio)) +
geom_bar(stat='identity') +
labs(title='Ratio of inspection closures by top 20 cuisine',
x='Cuisine (top 20)',
y='Inspection closure ratio') +
scale_y_continuous(limits=c(0,0.03),
breaks=seq(0,3,0.005),
labels = scales::percent) +
theme_bw() +
coord_flip()
#Restaurants that were closed at least once (closures, not reclosures as part of the same inspection cycle)
reclosedByCuisine = unique(
inspectionsFiltered %>%
filter(., action == 'closed') %>%
select(., camis, cuisine, inspection.date)) %>%
group_by(., camis, cuisine) %>%
summarise(., closures = n()) %>%
group_by(., cuisine) %>%
summarise(., closed_once = sum(closures==1),
closed_more_than_once = sum(closures>1),
total_closed = n(),
ratio = closed_more_than_once / total_closed)
#Bar plot: Ratio of restaurants by top 20 cuisine that were closed more than once, out of restaurants that were closed at least once
ggplot(data = reclosedByCuisine, aes (x = reorder(cuisine, ratio), y = ratio)) +
geom_bar(stat='identity') +
labs(title='Ratio of repeat closures by top 20 cuisine',
x='Cuisine (top 20)',
y='Repeat closure ratio') +
scale_y_continuous(limits=c(0,0.2),
breaks=seq(0,0.2,0.05),
labels=scales::percent) +
theme_bw() +
coord_flip()
#Ratio of inspection closures by top 20 cuisine and boro
inspClosByCuisineBoro = inspectionsFiltered %>%
group_by(., cuisine, boro) %>%
summarise(.,
closures = sum(action == 'closed' | action == 'reclosed'),
reclosures = sum(action == 'reclosed'),
inspections = n(),
ratio = closures / inspections
)
#Refactor cuisines to keep same order as in previous plot
inspClosByCuisineBoro$cuisine = factor(inspClosByCuisineBoro$cuisine)
newFactor = levels(inspClosByCuisineBoro$cuisine)[order(-rank(inspClosByCuisine$ratio))]
inspClosByCuisineBoro$cuisine = factor(inspClosByCuisineBoro$cuisine, levels=rev(newFactor))
#Faceted bar plot: Inspection closure ratio by top 20 cuisine and borough
ggplot(data=inspClosByCuisineBoro, aes(x=cuisine, y=ratio)) +
geom_bar(stat='identity', aes(fill=boro)) +
facet_grid(. ~ boro) +
labs(title='Inspection closure ratio by top 20 cuisine and borough', x='Cuisine (top 20)', y='Inspection closure ratio') +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = 'Set1', name = 'Borough') +
theme_bw() +
theme(legend.key=element_blank(), legend.position="bottom") +
coord_flip()
reclosedByBoro
inspClosByBoro
e <- data.frame(x = c(1, 1, 2, 3), z = 1:4)
f <- data.frame(x = c(1, 2, 2, 4), z = 1:4)
j <- inner_join(tbl_cpp(e), tbl_cpp(f), "x")
e <- data.frame(x = c(1, 1, 2, 3), z = 1:4)
f <- data.frame(x = c(1, 2, 2, 4), z = 1:4)
j <- inner_join(tbl_df(e), tbl_df(f), "x")
j
rm(j,e,f)
inspClosByBoro
reclosedByBoro
left_join(inspClosByBoro, reclosedByBoro, by = boro)
left_join(inspClosByBoro, reclosedByBoro, by = 'boro')
left_join(inspClosByBoro, reclosedByBoro, by = 'boro') %>%
rename(., inspRatio = ratio.x, recloRatio = ratio.y)
boroClosureRatios = left_join(inspClosByBoro, reclosedByBoro, by = 'boro') %>%
rename(., inspRatio = ratio.x, recloRatio = ratio.y)
ggplot(data = boroClosureRatios, aes(x=inspRatio, y=recloRatio)) +
geom_point()
ggplot(data = boroClosureRatios, aes(x=inspRatio, y=recloRatio)) +
geom_point(aes(colour = boro))
ggplot(data = boroClosureRatios, aes(x=inspRatio, y=recloRatio)) +
geom_point(aes(colour = boro)) +
scale_fill_brewer(palette = 'Set1', name = 'Borough') +
theme_bw() +
theme(legend.key=element_blank())
ggplot(data = boroClosureRatios, aes(x=inspRatio, y=recloRatio)) +
geom_point(aes(colour = boro)) +
labs(title='Closure and reclosure ratios by borough',
x='Inspection closure ratio',
y='Reclosure ratio') +
scale_x_continuous(labels = scales::percent) +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = 'Set1', name = 'Borough') +
theme_bw() +
theme(legend.key=element_blank())
ggplot(data = boroClosureRatios, aes(x=inspRatio, y=recloRatio)) +
geom_point(aes(fill = boro)) +
labs(title='Closure and reclosure ratios by borough',
x='Inspection closure ratio',
y='Reclosure ratio') +
scale_x_continuous(labels = scales::percent) +
scale_y_continuous(labels = scales::percent) +
scale_fill_brewer(palette = 'Set1', name = 'Borough') +
theme_bw() +
theme(legend.key=element_blank(), name = 'Borough')
ggplot(data = boroClosureRatios, aes(x=inspRatio, y=recloRatio)) +
geom_point(aes(colour = boro)) +
labs(title='Closure and reclosure ratios by borough',
x='Inspection closure ratio',
y='Reclosure ratio') +
scale_x_continuous(labels = scales::percent) +
scale_y_continuous(labels = scales::percent) +
scale_colour_brewer(palette = 'Set1', name = 'Borough') +
theme_bw() +
theme(legend.key=element_blank())
ggplot(data = boroClosureRatios, aes(x=inspRatio, y=recloRatio)) +
geom_point(aes(colour = boro)) +
labs(title='Closure and reclosure ratios by borough',
x='Inspection closure ratio',
y='Reclosure ratio') +
scale_x_continuous(labels = scales::percent) +
scale_y_continuous(labels = scales::percent) +
scale_colour_brewer(palette = 'Set1', name = 'Borough', size = 10) +
theme_bw() +
theme(legend.key=element_blank())
ggplot(data = boroClosureRatios, aes(x=inspRatio, y=recloRatio)) +
geom_point(aes(colour = boro), size = 10) +
labs(title='Closure and reclosure ratios by borough',
x='Inspection closure ratio',
y='Reclosure ratio') +
scale_x_continuous(labels = scales::percent) +
scale_y_continuous(labels = scales::percent) +
scale_colour_brewer(palette = 'Set1', name = 'Borough') +
theme_bw() +
theme(legend.key=element_blank())
ggplot(data = boroClosureRatios, aes(x=inspRatio, y=recloRatio)) +
geom_point(aes(colour = boro), size = 3) +
labs(title='Closure and reclosure ratios by borough',
x='Inspection closure ratio',
y='Reclosure ratio') +
scale_x_continuous(labels = scales::percent) +
scale_y_continuous(labels = scales::percent) +
scale_colour_brewer(palette = 'Set1', name = 'Borough') +
theme_bw() +
theme(legend.key=element_blank())

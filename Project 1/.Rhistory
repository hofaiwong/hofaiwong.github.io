x='Month',
y='Inspection closure ratio'
)
ggplot(data=closingsByMonth, aes(x=month, y=ratio)) +
geom_point()
ggplot(data=closingsByMonth, aes(x=month, y=ratio)) +
geom_line()
ggplot(data=closingsByMonth, aes(x=month, y=ratio)) +
geom_smooth()
ggplot(data=closingsByMonth, aes(x=month, y=ratio)) +
geom_line()
ggplot(data=closingsByMonth, aes(x=month, y=ratio)) +
geom_line() +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio'
)
closingsByMonthBoro = inspections %>%
mutate(., month=month(inspection.date)) %>%
group_by(., month, boro) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections
)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_freqpoly(stat='identity',aes(color=boro, binwidth=1)) +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio'
)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_bar(stat='identity',aes(color=boro, binwidth=1)) +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio'
)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_bar(stat='identity',aes(color=boro, binwidth=1, position='dodge')) +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio'
)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_bar(stat='identity',aes(fill=boro, binwidth=1, position='dodge')) +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio'
)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_bar(stat='identity', aes(fill=boro, binwidth=1, position='dodge')) +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio'
)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_bar(stat='identity', aes(fill=boro, binwidth=1), position='dodge') +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio'
)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_freqpoly(stat='identity', aes(fill=boro, binwidth=1)) +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio'
)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro, binwidth=1)) +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio'
)
inspectionSummaryByMonth = merge(cntInspections, cntClosings, by = c('boro','yearmon'), all=T)
inspections
inspections = unique(select(raw.df, camis, boro, zipcode, cuisine, inspection.date, action, score, new_grade, yearmon)) #unique inspections
latest = merge(aggregate(inspection.date ~ camis, inspections, max), inspections) #latest scores only
restaurants = unique(select(latest, camis, boro, zipcode, cuisine, score, new_grade)) #unique restaurants
closingsByMonth = inspections %>%
mutate(., month=month(inspection.date)) %>%
group_by(., month) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections
)
ggplot(data=closingsByMonth, aes(x=month, y=ratio)) +
geom_line() +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio'
)
closingsByMonthBoro = inspections %>%
mutate(., month=month(inspection.date)) %>%
group_by(., month, boro) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections
)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro, binwidth=1)) +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio'
)
inspections
inspections %>%
group_by(., yearmon, boro) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections
)
ClosingsByYearMonBoro = inspections %>%
group_by(., yearmon, boro) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections
)
gglot(data=ClosingsByYearMonBoro, aes(x=yearmon, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro, binwidth=1)) +
labs(title='Inspection closure ratio over time',
x='Month/Year',
y='Inspection closure ratio'
)
ggplot(data=ClosingsByYearMonBoro, aes(x=yearmon, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro, binwidth=1)) +
labs(title='Inspection closure ratio over time',
x='Month/Year',
y='Inspection closure ratio'
)
inspections
inspections %>%
group_by(., boro, inspection.date) %>%
summarise(., avg = mean(score))
ggplot(data=trendScoreBoro, aes(x = inspection.date, y = avg)) +
geom_freqpoly(stat='identity', aes(color=boro))
trendScoreBoro = inspections %>%
group_by(., boro, inspection.date) %>%
summarise(., avg = mean(score))
ggplot(data=trendScoreBoro, aes(x = inspection.date, y = avg)) +
geom_freqpoly(stat='identity', aes(color=boro))
ggplot(data=trendScoreBoro, aes(x = inspection.date, y = avg)) +
geom_freqpoly(stat='identity', aes(color=boro, binwidth=40))
ggplot(data=ClosingsByYearMonBoro, aes(x=yearmon, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro), binwidth=1) +
labs(title='Inspection closure ratio over time',
x='Month/Year',
y='Inspection closure ratio'
)
ggplot(data=ClosingsByYearMonBoro, aes(x=yearmon, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro), binwidth=1) +
labs(title='Inspection closure ratio over time',
x='Month/Year',
y='Inspection closure ratio'
)
library(ggplot2)
ggplot(data=ClosingsByYearMonBoro, aes(x=yearmon, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro), binwidth=1) +
labs(title='Inspection closure ratio over time',
x='Month/Year',
y='Inspection closure ratio'
)
ggplot(data=ClosingsByYearMonBoro, aes(x=yearmon, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro), binwidth=1) +
labs(title='Inspection closure ratio over time',
x='Month/Year',
y='Inspection closure ratio'
)
ggplot(data=latest, aes(x = score)) +
geom_freqpoly(aes(color=boro), binwidth=2) +
coord_cartesian(xlim=c(0,40)) +
labs(title='Restaurants by latest score and borough', x='Score', y='Restaurants') +
scale_colour_discrete(name="Borough")
ggplot(data=ClosingsByYearMonBoro, aes(x=yearmon, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro), binwidth=1)
ggplot(data=ClosingsByYearMonBoro, aes(x=yearmon, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro)) +
labs(title='Inspection closure ratio over time',
x='Month/Year',
y='Inspection closure ratio'
)
ggplot(data=ClosingsByYearMonBoro, aes(x=yearmon) +
geom_freqpoly(stat='identity', aes(color=boro)) +
labs(title='Inspection closure ratio over time',
x='Month/Year',
y='Inspection closure ratio'
)
ggplot(data=ClosingsByYearMonBoro, aes(x=yearmon) +
geom_freqpoly(stat='identity', aes(color=boro)) +
labs(title='Inspection closure ratio over time',
x='Month/Year',
y='Inspection closure ratio'
)
ggplot(data=ClosingsByYearMonBoro, aes(x=yearmon)) +
geom_freqpoly(stat='identity', aes(color=boro)) +
labs(title='Inspection closure ratio over time',
x='Month/Year',
y='Inspection closure ratio'
)
ggplot(data=ClosingsByYearMonBoro, aes(x=yearmon)) +
geom_freqpoly(aes(color=boro)) +
labs(title='Inspection closure ratio over time',
x='Month/Year',
y='Inspection closure ratio'
)
ggplot(data=ClosingsByYearMonBoro, aes(x=yearmon, y=ratio)) +
geom_freqpoly(aes(color=boro)) +
labs(title='Inspection closure ratio over time',
x='Month/Year',
y='Inspection closure ratio'
)
ggplot(data=ClosingsByYearMonBoro, aes(x=yearmon, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro)) +
labs(title='Inspection closure ratio over time',
x='Month/Year',
y='Inspection closure ratio'
)
ggplot(data=ClosingsByYearMonBoro, aes(x=yearmon, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro)) +
labs(title='Inspection closure ratio over time',
x='Month/Year',
y='Inspection closure ratio'
) +
facet_grid(boro)
ggplot(data=ClosingsByYearMonBoro, aes(x=yearmon, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro)) +
labs(title='Inspection closure ratio over time',
x='Month/Year',
y='Inspection closure ratio'
) + facet_grid(~boro)
ggplot(data=ClosingsByYearMonBoro, aes(x=yearmon, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro)) +
labs(title='Inspection closure ratio over time',
x='Month/Year',
y='Inspection closure ratio'
)
inspections %>%
group_by(., boro, inspection.date) %>%
summarise(., avg = mean(score))
ggplot(data=trendScoreBoro, aes(x = inspection.date, y = avg)) +
geom_freqpoly(stat='identity', aes(color=boro))
ggplot(data=trendScoreBoro, aes(x = inspection.date, y = avg)) +
geom_freqpoly(stat='identity', aes(color=boro), binwidth=1000)
?geom_freqpoly
ggplot(data=trendScoreBoro, aes(x = inspection.date, y = avg)) +
geom_line(stat='identity', aes(color=boro), binwidth=1000)
ggplot(data=trendScoreBoro, aes(x = inspection.date, y = avg)) +
geom_line(stat='identity', aes(color=boro))
?geom_line
ggplot(data=trendScoreBoro, aes(x = inspection.date, y = avg)) +
geom_smooth(stat='identity', aes(color=boro))
library(plyr)
library(dplyr)
library(zipcode)
library(ggplot2)
ggplot (data = inspections[inspections$action %in% c('closed','reclosed'),], aes (x = inspection.date)) +
geom_density(aes(color = boro)) +
labs(title='Density of closings over time by borough', x='Inspection date', y='Density of closings') +
scale_colour_discrete(name="Borough")
#Density of inspections over time by borough
ggplot (data = inspections, aes (x = inspection.date)) +
geom_density(aes(color = boro)) +
labs(title = 'Density of inspections over time by borough', x='Inspection date', y='Density of inspections') +
scale_colour_discrete(name="Borough")
closingsByMonthBoro = inspections %>%
mutate(., month=month(inspection.date)) %>%
group_by(., month, boro) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections
)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro, binwidth=1)) +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio'
)
library(lubridate)
# #Trend of inspection closure ratio by month and borough
closingsByMonthBoro = inspections %>%
mutate(., month=month(inspection.date)) %>%
group_by(., month, boro) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections
)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro, binwidth=1)) +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio'
)
View(closingsByMonthBoro)
inspections %>%
mutate(., month=month(inspection.date)) %>%
group_by(., month, boro) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections,
month.abb[month]
)
month.abb[1]
inspections %>%
mutate(., month=month(inspection.date)) %>%
group_by(., month, boro) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections,
month.abb[month]
)
month.abb[inspections$month(inspection.date)]
month(inspection.date)
month(inspections$inspection.date)
month.abb[month(inspections$inspection.date)]
inspections %>%
mutate(., month=month.abb[month(inspection.date)])
inspections %>%
mutate(., month=month.abb[month(inspection.date)]) %>%
group_by(., month, boro) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections
)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro, binwidth=1)) +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio'
)
closingsByMonthBoro = inspections %>%
mutate(., month=month.abb[month(inspection.date)]) %>%
group_by(., month, boro) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections
)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro, binwidth=1)) +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio'
)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro)) +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio'
)
View(closingsByMonthBoro)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro))
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_line(stat='identity', aes(color=boro))
library(plyr)
library(dplyr)
library(zipcode)
library(ggplot2)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_line(stat='identity', aes(color=boro)) +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio'
)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_line(stat='identity')
class(closingsByMonthBoro$month)
?factor
closingsByMonthBoro$month = factor(closingsByMonth$month, levels=c("Jan","Feb","Mar","Apr","May","Jun",
"Jul","Aug","Sep","Oct","Nov","Dec"))
class(closingsByMonthBoro$month)
levels(closingsByMonthBoro)
levels(closingsByMonthBoro$month)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_line(stat='identity') +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio'
)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_freqpoly(stat='identity')
closingsByMonthBoro = inspections %>%
mutate(., month=month.abb[month(inspection.date)]) %>%
group_by(., month, boro) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections
)
closingsByMonthBoro$month = factor(closingsByMonth$month, levels=c("Jan","Feb","Mar","Apr","May","Jun",
"Jul","Aug","Sep","Oct","Nov","Dec"))
closingsByMonthBoro = inspections %>%
mutate(., month=month.abb[month(inspection.date)]) %>%
group_by(., month, boro) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections
)
closingsByMonthBoro = inspections %>%
mutate(., month=month.abb[month(inspection.date)]) %>%
group_by(., month, boro) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections
)
?as.factor
closingsByMonthBoro$month = factor(closingsByMonthBoro$month, levels=c("Jan","Feb","Mar","Apr","May","Jun",
"Jul","Aug","Sep","Oct","Nov","Dec"))
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_freqpoly(stat='identity') +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio'
)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_freqpoly()
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro))
ggplot (data = inspections, aes (x = inspection.date)) +
geom_density(aes(color = boro)) +
labs(title = 'Density of inspections over time by borough', x='Inspection date', y='Density of inspections') +
scale_colour_discrete(name="Borough")
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_freqpoly(stat='identity', aes(color=boro))
ggplot(data=latest, aes(x = score)) +
geom_freqpoly(aes(color=boro), binwidth=2) +
coord_cartesian(xlim=c(0,40)) +
labs(title='Restaurants by latest score and borough', x='Score', y='Restaurants') +
scale_colour_discrete(name="Borough")
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_line(stat='identity', aes(color=boro))
closingsByMonthBoro = inspections %>%
mutate(., month=month(inspection.date)) %>%
group_by(., month, boro) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections
)
closingsByMonthBoro$month = factor(closingsByMonthBoro$month, levels=c("Jan","Feb","Mar","Apr","May","Jun",
"Jul","Aug","Sep","Oct","Nov","Dec"))
closingsByMonthBoro = inspections %>%
mutate(., month=month(inspection.date)) %>%
group_by(., month, boro) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections
)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_line(stat='identity', aes(color=boro)) +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio'
)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_line(stat='identity', aes(color=boro)) +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio'
) +
coord_cartesian(xlim = c(1,12))
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_line(stat='identity', aes(color=boro)) +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio') +
coord_cartesian(xlim = c(1,12))
seq(1:12,1)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_line(stat='identity', aes(color=boro)) +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio') +
coord_cartesian(xlim = c(1,12)) +
scale_x_continuous(breaks = 1:12)
ggplot(data=closingsByMonthBoro, aes(x=month, y=ratio)) +
geom_line(stat='identity', aes(color=boro)) +
labs(title='Inspection closure ratio by month',
x='Month',
y='Inspection closure ratio') +
coord_cartesian(xlim = c(1,12)) +
scale_x_continuous(breaks = 1:12,
labels=c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"))

ggplot(data=latest, aes(x=reorder(boro, boro, function(x)-length(x)), y=score)) +
geom_boxplot(aes(fill=boro)) +
labs(title='Latest scores by borough', x='Borough', y='Latest scores') +
stat_summary(fun.y=mean, colour="white", geom="point", shape=16, size=2)
ggplot(data=latest, aes(x=reorder(boro, boro, function(x)-length(x)), y=score)) +
geom_boxplot(aes(fill=boro)) +
labs(title='Latest scores by borough', x='Borough', y='Latest scores') +
stat_summary(fun.y=mean, colour="white", geom="point", shape=16, size=1)
ggplot(data=latest, aes(x=reorder(boro, boro, function(x)-length(x)), y=score)) +
geom_boxplot(aes(fill=boro)) +
labs(title='Latest scores by borough', x='Borough', y='Latest scores') +
stat_summary(fun.y=mean, colour="white", geom="point", shape=16, size=2)
View(latest)
ggplot(data=latest, aes(x=reorder(cuisine, cuisine, function(x)-length(x)))) +
geom_bar(aes(fill=new_grade), position='dodge') +
labs(title='Restaurants by latest grades and cuisine', x='Cuisine', y='Restaurants') +
scale_fill_discrete(name="Latest \ngrades")
ggplot(data=latest, aes(y=cuisine)) + geom_bar()
ggplot(data=latest, aes(x=cuisine)) + geom_bar() + coord_flip()
ggplot(data=latest, aes(x=reorder(cuisine, cuisine, function(x)-length(x)))) + geom_bar() + coord_flip()
ggplot(data=latest, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) + geom_bar() + coord_flip()
ggplot(data=restaurants, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) + geom_bar() + coord_flip()
View(restaurants)
top_n(., 5)
#Current state stats by cuisine
restaurants %>%
group_by(., boro, cuisine) %>%
summarise(., count=n())
library(dplyr)
restaurants %>%
group_by(., boro, cuisine) %>%
summarise(., count=n())
library(plyr)
library(dplyr)
restaurants %>%
group_by(., boro, cuisine) %>%
summarise(., count=n())
library(plyr)
library(dplyr)
restaurants %>%
group_by(., boro, cuisine) %>%
summarise(., count=n())
restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n())
restaurantsByCuisine = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n())
ggplot(data=restaurantsByCuisine, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) + geom_bar() + coord_flip()
library(ggplot2)
ggplot(data=restaurantsByCuisine, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) + geom_bar() + coord_flip()
ggplot(data=restaurantsByCuisine, aes(x=reorder(cuisine, cuisine, count))) + geom_bar() + coord_flip()
restaurantsByCuisine = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n())
View(restaurantsByCuisine)
View(restaurants)
ggplot(data=restaurants, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) + geom_bar() + coord_flip()
?top_n
restaurantsByCuisine = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n())
restaurantsByCuisine = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n()) %>%
top_n(., 40, count)
restaurantsByCuisine = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n())
sum(restaurantsByCuisine$count)
sum(restByCuisineFiltered$count) / sum(restByCuisine$count) #coverage of restaurants after filtering
restByCuisine = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n())
restByCuisineFiltered = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n()) %>%
top_n(., 40, count)
sum(restByCuisineFiltered$count) / sum(restByCuisine$count) #coverage of restaurants after filtering
restByCuisine = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n())
restByCuisineFiltered = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n()) %>%
top_n(., 30, count)
sum(restByCuisineFiltered$count) / sum(restByCuisine$count) #coverage of restaurants after filtering
restByCuisine = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n())
restByCuisineFiltered = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n()) %>%
top_n(., 20, count)
sum(restByCuisineFiltered$count) / sum(restByCuisine$count) #coverage of restaurants after filtering
restByCuisine = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n())
restByCuisineFiltered = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n()) %>%
top_n(., 30, count)
sum(restByCuisineFiltered$count) / sum(restByCuisine$count) #coverage of restaurants after filtering
ggplot(data=restByCuisineFiltered, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) +
geom_bar() +
coord_flip()
restByCuisine = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n()) %>%
arrange(., desc(count))
restByCuisineFiltered = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n()) %>%
arrange(., desc(count)) %>%
top_n(., 30, count)
ggplot(data=restByCuisineFiltered, aes(x=cuisine, y=count)) +
geom_bar(stat='identity') +
coord_flip()
#Visualize current state by cuisine
ggplot(data=restByCuisineFiltered, aes(x=reorder(cuisine, count), y=count)) +
geom_bar(stat='identity') +
coord_flip()
ggplot(data=restByCuisineFiltered, aes(x=reorder(cuisine, count), y=count)) +
geom_bar(stat='identity', fill=boro) +
coord_flip() +
labs(title='')
sum(restByCuisineFiltered$count) / sum(restByCuisine$count) #coverage of restaurants after filtering
restByCuisine = restaurants %>%
group_by(., cuisine, boro) %>%
summarise(., count=n()) %>%
arrange(., desc(count))
restByCuisineFiltered = restaurants %>%
group_by(., cuisine, boro) %>%
summarise(., count=n()) %>%
arrange(., desc(count)) %>%
top_n(., 30, count)
sum(restByCuisineFiltered$count) / sum(restByCuisine$count) #coverage of restaurants after filtering
sum(restByCuisineFiltered$count) / sum(restByCuisine$count) #coverage of restaurants after filtering
restByCuisine = restaurants %>%
group_by(., cuisine, boro) %>%
summarise(., count=n()) %>%
arrange(., desc(count))
View(restByCuisine)
restByCuisineFiltered = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n()) %>%
arrange(., desc(count)) %>%
top_n(., 30, count)
restByCuisine = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n()) %>%
arrange(., desc(count))
restByCuisineFiltered = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n()) %>%
arrange(., desc(count)) %>%
top_n(., 30, count)
View(restByCuisine)
View(restByCuisineFiltered)
View(restByCuisine)
View(restByCuisineFiltered)
View(restByCuisine)
restaurantsFiltered = inner_join(restaurants, restByCuisineFiltered, by = 'cuisine')
View(restaurantsFiltered)
sum(restByCuisineFiltered$count)
View(restByCuisineFiltered)
restaurantsFiltered = semi_join(restaurants, restByCuisineFiltered, by = 'cuisine')
#Visualize current state by cuisine
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) +
geom_bar(fill=boro) +
coord_flip() +
labs(title='')
restaurantsFiltered = semi_join(restaurants, restByCuisineFiltered, by = 'cuisine')
#Visualize current state by cuisine
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) +
geom_bar(fill=boro) +
coord_flip() +
labs(title='')
restaurantsFiltered = semi_join(restaurants, restByCuisineFiltered, by = 'cuisine')
View(restaurantsFiltered)
restByCuisine = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n()) %>%
arrange(., desc(count))
View(restByCuisine)
restByCuisineFiltered = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n()) %>%
arrange(., desc(count)) %>%
top_n(., 30, count)
View(restByCuisineFiltered)
View(restaurants)
restaurants = unique(select(raw.df, camis, boro, zipcode, cuisine))
restaurants = unique(select(latest, camis, boro, zipcode, cuisine, score))
restaurants = unique(select(latest, camis, boro, zipcode, cuisine, score, new_grade))
restaurants = unique(select(latest, camis, boro, zipcode, cuisine, score, new_grade))
ggplot(data = restaurants, aes(x=reorder(boro, boro, function(x)-length(x)))) + geom_bar()
ggplot(data = restaurants, aes(x=reorder(boro, boro, function(x)-length(x)))) + geom_bar(fill=new_grade)
restaurants = unique(select(latest, camis, boro, zipcode, cuisine, score, new_grade))
ggplot(data = restaurants, aes(x=reorder(boro, boro, function(x)-length(x)))) + geom_bar(fill=new_grade)
View(restaurants)
ggplot(data = restaurants, aes(x=reorder(boro, boro, function(x)-length(x)))) + geom_bar(fill=new_grade)
ggplot(data = restaurants, aes(x=reorder(boro, boro, function(x)-length(x)))) + geom_bar(aes(fill=new_grade))
#Current state stats by cuisine
restByCuisine = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n()) %>%
arrange(., desc(count))
restByCuisineFiltered = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n()) %>%
arrange(., desc(count)) %>%
top_n(., 30, count)
sum(restByCuisineFiltered$count) / sum(restByCuisine$count) #coverage of restaurants after filtering; will keep top 30 covering 91%
restaurantsFiltered = semi_join(restaurants, restByCuisineFiltered, by = 'cuisine')
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) +
geom_bar(fill=boro) +
coord_flip() +
labs(title='')
View(restaurants)
View(restaurantsFiltered)
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) +
geom_bar(aes(fill=boro)) +
coord_flip() +
labs(title='')
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) +
geom_bar(aes(fill=new_grade)) +
coord_flip() +
labs(title='')
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) +
geom_bar(aes(fill=new_grade)) +
coord_flip() +
labs(title='Restaurants by cuisine and grade',
x='Restaurants',
y='Cuisine (Top 30)')
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) +
geom_bar(aes(fill=new_grade)) +
coord_flip() +
labs(title='Restaurants by cuisine (top 30) and grade',
x='Cuisine (Top 30)',
y='Restaurants')
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) +
geom_bar(aes(fill=new_grade), name='Grade') +
coord_flip() +
labs(title='Restaurants by cuisine (top 30) and grade',
x='Cuisine (Top 30)',
y='Restaurants')
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) +
geom_bar(aes(fill=new_grade), names='Grade') +
coord_flip() +
labs(title='Restaurants by cuisine (top 30) and grade',
x='Cuisine (Top 30)',
y='Restaurants')
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) +
geom_bar(aes(fill=new_grade)) +
coord_flip() +
labs(title='Restaurants by cuisine (top 30) and grade',
x='Cuisine (Top 30)',
y='Restaurants') +
scale_fill_discrete(name='Grade')
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) +
geom_bar(aes(fill=new_grade)) +
coord_flip() +
labs(title='Restaurants by cuisine (top 30) and grade',
x='Cuisine (Top 30)',
y='Restaurants') +
scale_fill_discrete(name='Grade') +
scale_fill_brewer()
#Visualize current state by cuisine
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) +
geom_bar(aes(fill=new_grade)) +
coord_flip() +
labs(title='Restaurants by cuisine (top 30) and grade',
x='Cuisine (Top 30)',
y='Restaurants') +
scale_fill_discrete(name='Grade') +
scale_fill_brewer(palette='Blues')
#Visualize current state by cuisine
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) +
geom_bar(aes(fill=new_grade)) +
coord_flip() +
labs(title='Restaurants by cuisine (top 30) and grade',
x='Cuisine (Top 30)',
y='Restaurants') +
#scale_fill_discrete(name='Grade') +
scale_fill_brewer(palette='Blues')
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) +
geom_bar(aes(fill=new_grade)) +
coord_flip() +
labs(title='Restaurants by cuisine (top 30) and grade',
x='Cuisine (Top 30)',
y='Restaurants') +
scale_fill_discrete(name='Grade')
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, cuisine, function(x) length(x)), y=score)) +
geom_boxplot(aes(fill=boro))
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, cuisine, function(x) length(x)), y=score)) +
geom_boxplot()
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, cuisine, function(x) length(x)), y=score)) +
geom_boxplot() +
coord_flip()
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, score), y=score)) +
geom_boxplot() +
coord_flip()
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, -score), y=score)) +
geom_boxplot() +
coord_flip()
e
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, -score), y=score)) +
geom_boxplot(aes(fill=new_grade)) +
coord_flip()
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, -score), y=score)) +
geom_boxplot() +
coord_flip()
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) +
geom_bar(aes(fill=new_grade)) +
coord_flip() +
labs(title='Restaurants by cuisine (top 30) and grade',
x='Cuisine (Top 30)',
y='Restaurants') +
scale_fill_discrete(name='Grade')
ggplot(data=restaurantsFiltered, aes(x=cuisine)) + geom_bar(aes(fill=new_grade)) + coord_flip()
ggplot(data=restaurantsFiltered, aes(x=cuisine)) + geom_bar(aes(fill=new_grade), position = 'fill') + coord_flip()
ggplot (data=restaurantsFiltered, aes(x=cuisine)) + geom_histogram(binwidth = 2, aes(fill = cuisine)) + coord_flip()
ggplot(data=restaurantsFiltered, aes(x=score)) +
geom_histogram(binwidth = 2, aes(fill = cuisine)) +
coord_flip()
ggplot(data=restaurantsFiltered, aes(x=score)) +
geom_histogram(binwidth = 2, aes(fill = cuisine))
ggplot(data=restaurantsFiltered, aes(x=score)) +
geom_histogram(binwidth = 2, aes(fill = new_grade))
ggplot(data=restaurantsFiltered, aes(x = score)) +
geom_freqpoly(aes(color=cuisine), binwidth=2)
ggplot(data=latest, aes (x=score)) +
geom_density(aes(color=cuisine)
ggplot(data=latest, aes (x=score)) +
geom_density(aes(color=cuisine))
ggplot(data=latest, aes (x=score)) +
geom_density(aes(color=cuisine))
ggplot(data=restaurantsFiltered, aes (x=score)) +
geom_density(aes(color=cuisine))
restByCuisine = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n()) %>%
arrange(., desc(count))
restByCuisineFiltered = restaurants %>%
group_by(., cuisine) %>%
summarise(., count=n()) %>%
arrange(., desc(count)) %>%
top_n(., 10, count)
sum(restByCuisineFiltered$count) / sum(restByCuisine$count) #coverage of restaurants after filtering
restaurantsFiltered = semi_join(restaurants, restByCuisineFiltered, by = 'cuisine') #Will keep top 30 covering 91%
ggplot(data=restaurantsFiltered, aes(x=reorder(cuisine, cuisine, function(x) length(x)))) +
geom_bar(aes(fill=new_grade)) +
coord_flip() +
labs(title='Restaurants by cuisine (top 30) and grade',
x='Cuisine (Top 30)',
y='Restaurants') +
scale_fill_discrete(name='Grade')
ggplot(data=restaurantsFiltered, aes(x = score)) +
geom_freqpoly(aes(color=cuisine), binwidth=2) +
coord_cartesian(xlim=c(0,40)) +
labs(title='Restaurants by score and cuisine', x='Score', y='Restaurants') +
scale_colour_discrete(name="Cuisine")
ggplot(data=restaurantsFiltered, aes (x=score)) +
geom_density(aes(color=cuisine)) +
coord_cartesian(xlim=c(0,40)) +
labs(title='Density of restaurants by score and cuisine', x='Score', y='Density') +
scale_colour_discrete(name="Cuisine")
inspections %>%
group_by(., cuisine, yearmon) %>%
summarise(., inspections=n())
inspectionsByMonthByCuisine = inspections %>%
group_by(., cuisine, yearmon) %>%
summarise(., inspections=n())
closingsByMonthByCuisine = inspections %>%
filter(., action %in% c('closed','reclosed')) %>%
group_by(., cuisine, yearmon) %>%
summarise(., closings=n())
reclosingsByMonth = inspections %>%
filter(., action=='reclosed') %>%
group_by(., cuisine, yearmon) %>%
summarise(., reclosings=n())
inspectionsByMonthByCuisine = inspections %>%
group_by(., cuisine, yearmon) %>%
summarise(., inspections=n())
closingsByMonthByCuisine = inspections %>%
filter(., action %in% c('closed','reclosed')) %>%
group_by(., cuisine, yearmon) %>%
summarise(., closings=n())
reclosingsByMonth = inspections %>%
filter(., action=='reclosed') %>%
group_by(., cuisine, yearmon) %>%
summarise(., reclosings=n())
###Ratio of inspections that lead to closings by cuisine
inspectionClosingSummaryByCuisine = cbind(summarize(group_by(closingsByMonthByCuisine, cuisine), closings = sum(closings)),
summarize(group_by(reclosingsByMonthByCuisine, cuisine), reclosings = sum(reclosings))[,2],
summarize(group_by(inspectionsByMonthByCuisine, cuisine), inspections = sum(inspections))[,2])
inspectionClosingSummaryByCuisine = mutate(inspectionClosingSummaryByCuisine, ratio = closings / inspections)
inspectionClosingRatioByCuisine.gg = ggplot(data=inspectionClosingSummaryByCuisine, aes(x=reorder(cuisine, -ratio), y=ratio)) +
geom_bar(stat='identity') +
labs(title='Inspection closing ratio by cuisine', x='Cuisine', y='Inspection closing ratio')
inspectionClosingRatioByCuisine.gg #Overall inspection closing ratio by borough
inspectionsByMonthByCuisine = inspections %>%
group_by(., cuisine, yearmon) %>%
summarise(., inspections=n())
closingsByMonthByCuisine = inspections %>%
filter(., action %in% c('closed','reclosed')) %>%
group_by(., cuisine, yearmon) %>%
summarise(., closings=n())
reclosingsByMonth = inspections %>%
filter(., action=='reclosed') %>%
group_by(., cuisine, yearmon) %>%
summarise(., reclosings=n())
inspectionClosingSummaryByCuisine = cbind(summarize(group_by(closingsByMonthByCuisine, cuisine), closings = sum(closings)),
summarize(group_by(reclosingsByMonthByCuisine, cuisine), reclosings = sum(reclosings))[,2],
summarize(group_by(inspectionsByMonthByCuisine, cuisine), inspections = sum(inspections))[,2])
reclosingsByMonthByCuisine = inspections %>%
filter(., action=='reclosed') %>%
group_by(., cuisine, yearmon) %>%
summarise(., reclosings=n())
inspectionClosingSummaryByCuisine = cbind(summarize(group_by(closingsByMonthByCuisine, cuisine), closings = sum(closings)),
summarize(group_by(reclosingsByMonthByCuisine, cuisine), reclosings = sum(reclosings))[,2],
summarize(group_by(inspectionsByMonthByCuisine, cuisine), inspections = sum(inspections))[,2])
inspectionClosingSummaryByCuisine = mutate(inspectionClosingSummaryByCuisine, ratio = closings / inspections)
t1 = summarize(group_by(closingsByMonthByCuisine, cuisine), closings = sum(closings))
t2 = summarize(group_by(reclosingsByMonthByCuisine, cuisine), reclosings = sum(reclosings))
t3 = summarize(group_by(inspectionsByMonthByCuisine, cuisine), inspections = sum(inspections))
View(inspectionClosingSummary)
View(inspections)
inspections %>%
group_by(., boro) %>%
summarise(., closings = sum(action == 'closed' | action == 'reclosed'))
inspections %>%
group_by(., boro) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections
)
inspectionClosingSummary = inspections %>%
group_by(., boro) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections
)
inspectionClosingRatio.gg = ggplot(data=inspectionClosingSummary, aes(x=reorder(boro, -ratio), y=ratio)) +
geom_bar(stat='identity') +
labs(title='Inspection closing ratio by borough', x='Borough', y='Inspection closing ratio')
inspectionClosingRatio.gg #Overall inspection closing ratio by borough
inspections %>%
group_by(., cuisine) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections
)
inspectionClosingSummaryByCuisine = inspections %>%
group_by(., cuisine) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections
)
inspectionClosingRatioByCuisine.gg = ggplot(data=inspectionClosingSummaryByCuisine, aes(x=reorder(cuisine, -ratio), y=ratio)) +
geom_bar(stat='identity') +
labs(title='Inspection closing ratio by cuisine', x='Cuisine', y='Inspection closing ratio')
inspectionClosingRatioByCuisine.gg #Overall inspection closing ratio by borough
inspectionClosingRatioByCuisine.gg = ggplot(data=inspectionClosingSummaryByCuisine, aes(x=reorder(cuisine, -ratio), y=ratio)) +
geom_bar(stat='identity') +
labs(title='Inspection closing ratio by cuisine', x='Cuisine', y='Inspection closing ratio') +
coord_flip()
inspectionClosingRatioByCuisine.gg #Overall inspection closing ratio by borough
inspectionClosingRatioByCuisine.gg = ggplot(data=inspectionClosingSummaryByCuisine, aes(x=reorder(cuisine, ratio), y=ratio)) +
geom_bar(stat='identity') +
labs(title='Inspection closing ratio by cuisine', x='Cuisine', y='Inspection closing ratio') +
coord_flip()
inspectionClosingRatioByCuisine.gg #Overall inspection closing ratio by borough
inspectionClosingSummaryByCuisine = restaurantsFiltered %>%
group_by(., cuisine) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections
)
inspectionClosingSummaryByCuisine = inspectionsFiltered %>%
group_by(., cuisine) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections
)
inspectionsFiltered = semi_join(inspections, restByCuisineFiltered, by = 'cuisine')
inspectionClosingSummaryByCuisine = inspectionsFiltered %>%
group_by(., cuisine) %>%
summarise(.,
closings = sum(action == 'closed' | action == 'reclosed'),
reclosings = sum(action == 'reclosed'),
inspections = n(),
ratio = closings / inspections
)
inspectionClosingRatioByCuisine.gg = ggplot(data=inspectionClosingSummaryByCuisine, aes(x=reorder(cuisine, ratio), y=ratio)) +
geom_bar(stat='identity') +
labs(title='Inspection closing ratio by cuisine', x='Cuisine', y='Inspection closing ratio') +
coord_flip()
inspectionClosingRatioByCuisine.gg #Overall inspection closing ratio by borough
